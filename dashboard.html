<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8">
  <title>Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ù„ÛŒÙ†Ú©â€ŒÙ‡Ø§ÛŒ ÙˆÛŒØ²Ø§</title>
  <style>
    body { font-family: Tahoma; margin: 40px; direction: rtl; background-color: #f5f5f5; }
    h1 { color: #41b391; }
    h2 { margin-top: 30px; }
    .valid { color: green; }
    .expiring { color: orange; }
    .expired { color: red; }
    input, button { padding: 5px; margin-top: 10px; }
    .section { background: white; padding: 15px; border-radius: 8px; box-shadow: 0 0 5px #ccc; margin-bottom: 20px; }
    li { margin-bottom: 5px; }
  </style>
</head>
<body>

  <h1>ğŸ“Š Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ù„ÛŒÙ†Ú©â€ŒÙ‡Ø§ÛŒ ÙˆÛŒØ²Ø§</h1>

  <div class="section">
    <h2>â• Ø§ÙØ²ÙˆØ¯Ù† Ù„ÛŒÙ†Ú© Ø¬Ø¯ÛŒØ¯</h2>
    <input type="text" id="email" placeholder="Ø§ÛŒÙ…ÛŒÙ„"><br>
    <input type="text" id="token" placeholder="ØªÙˆÚ©Ù† Ù„ÛŒÙ†Ú©"><br>
    <button onclick="addLink()">Ø§ÙØ²ÙˆØ¯Ù†</button>
    <p id="message" style="color: green;"></p>
  </div>

  <div class="section">
    <h2 class="valid">âœ… Ù„ÛŒÙ†Ú©â€ŒÙ‡Ø§ÛŒ Ù…Ø¹ØªØ¨Ø±</h2>
    <ul id="validList"></ul>

    <h2 class="expiring">â³ Ù„ÛŒÙ†Ú©â€ŒÙ‡Ø§ÛŒ Ø¯Ø±Ø­Ø§Ù„ Ø§Ù†Ù‚Ø¶Ø§</h2>
    <ul id="expiringList"></ul>

    <h2 class="expired">âŒ Ù„ÛŒÙ†Ú©â€ŒÙ‡Ø§ÛŒ Ù…Ù†Ù‚Ø¶ÛŒâ€ŒØ´Ø¯Ù‡</h2>
    <ul id="expiredList"></ul>
  </div>

  <script>
    const links = [];

    function categorize(link) {
      const created = new Date(link.createdAt);
      const now = new Date();
      const hoursPassed = (now - created) / 3600000;
      const hoursLeft = 72 - hoursPassed;

      if (hoursLeft > 24) return 'valid';
      else if (hoursLeft > 0) return 'expiring';
      else return 'expired';
    }

    function render() {
      document.getElementById("validList").innerHTML = "";
      document.getElementById("expiringList").innerHTML = "";
      document.getElementById("expiredList").innerHTML = "";

      links.forEach(link => {
        const status = categorize(link);
        const li = `<li><strong>${link.email}</strong> | â³ ${Math.max(0, (72 - ((new Date() - new Date(link.createdAt)) / 3600000))).toFixed(2)} Ø³Ø§Ø¹Øª Ø¨Ø§Ù‚ÛŒâ€ŒÙ…Ø§Ù†Ø¯Ù‡</li>`;
        document.getElementById(status + "List").innerHTML += li;
      });
    }

    function addLink() {
      const email = document.getElementById("email").value.trim();
      const token = document.getElementById("token").value.trim();

      if (email && token) {
        links.push({
          email,
          token,
          link: `https://evisatraveller.mfa.ir/fa/request/confirm/${token}/`,
          createdAt: new Date().toISOString()
        });

        document.getElementById("email").value = "";
        document.getElementById("token").value = "";
        document.getElementById("message").innerText = "âœ… Ù„ÛŒÙ†Ú© Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯.";
        render();
      } else {
        document.getElementById("message").innerText = "âš ï¸ Ù„Ø·ÙØ§Ù‹ Ø§ÛŒÙ…ÛŒÙ„ Ùˆ ØªÙˆÚ©Ù† Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.";
      }
    }

    // Ø§Ú¯Ø± Ø¨Ø®ÙˆØ§ÛŒ Ù„ÛŒÙ†Ú©â€ŒÙ‡Ø§ÛŒ Ù‚Ø¨Ù„ÛŒ Ø±Ùˆ Ø§Ø² ÙØ§ÛŒÙ„ JSON Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ú©Ù†ÛŒØŒ Ù…ÛŒâ€ŒØªÙˆÙ†ÛŒÙ… Ø§Ø² fetch Ù‡Ù… Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒÙ… (Ø¨Ø§ Node.js Ø³Ø±ÙˆØ± Ø³Ø§Ø¯Ù‡)
  </script>
</body>
</html>